<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Using MUD on CoAP environments</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.2" rel="Chapter" title="2 MUD Architecture">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Problems">
<link href="#rfc.section.3" rel="Chapter" title="3 MUD architecture using CoAP">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Problems">
<link href="#rfc.section.4" rel="Chapter" title="4 Finding a policy: MUD URL advertisement">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Dynamic Host Configuration Protocol (DHCP)">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Neighbor Discovery Protocol (NDP)">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 NDP on 6LoWPANs">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Stateless autoconfiguration (SLAAC)">
<link href="#rfc.section.5" rel="Chapter" title="5 CoAP Operations">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Discovery">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Resource Directory">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Multicast">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Direct MUD discovery">
<link href="#rfc.section.6" rel="Chapter" title="6 MUD File">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Serialization">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.acknowledgments" rel="Chapter">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.41.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Jim&#233;nez, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-jimenez-t2trg-mud-coap-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2020-03-24" />
  <meta name="dct.abstract" content="This document provides some guidelines on how to add Manufacturer Usage Descriptions (MUD) to CoAP environments. " />
  <meta name="description" content="This document provides some guidelines on how to add Manufacturer Usage Descriptions (MUD) to CoAP environments. " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">T2TRG Research Group</td>
<td class="right">J. Jim&#233;nez</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Ericsson</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">March 24, 2020</td>
</tr>
<tr>
<td class="left">Expires: September 25, 2020</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Using MUD on CoAP environments<br />
  <span class="filename">draft-jimenez-t2trg-mud-coap-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document provides some guidelines on how to add Manufacturer Usage Descriptions (MUD) to CoAP environments.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 25, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">MUD Architecture</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Problems</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">MUD architecture using CoAP</a>
</li>
<ul><li>3.1.   <a href="#rfc.section.3.1">Problems</a>
</li>
</ul><li>4.   <a href="#rfc.section.4">Finding a policy: MUD URL advertisement</a>
</li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Dynamic Host Configuration Protocol (DHCP)</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Neighbor Discovery Protocol (NDP)</a>
</li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">NDP on 6LoWPANs</a>
</li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Stateless autoconfiguration (SLAAC)</a>
</li>
</ul><li>5.   <a href="#rfc.section.5">CoAP Operations</a>
</li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Discovery</a>
</li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">Resource Directory</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Multicast</a>
</li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Direct MUD discovery</a>
</li>
</ul></ul><li>6.   <a href="#rfc.section.6">MUD File</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">Serialization</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<ul><li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
</ul><li><a href="#rfc.acknowledgments">Acknowledgments</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">Manufacturer Usage Descriptions (MUDs) have been specified in <a href="#RFC8520" class="xref">[RFC8520]</a>. As the RFC states, the goal of MUD is to provide a means for end devices to signal to the network what sort of access and network functionality they require to properly function.</p>
<p id="rfc.section.1.p.2">Schemes that rely on connectivity to bootstrap the network might be flaky if that connectivity is not present, potentially preventing the device from working correctly in the absence of Internet connectivity. Moreover, even in environments that do provide connectivity it is unclear how continued operation can occur when the manufacturer&#8217;s server is no longer available.</p>
<p id="rfc.section.1.p.3">While <a href="#RFC8520" class="xref">[RFC8520]</a> contemplates the use of CoAP <a href="#RFC7252" class="xref">[RFC7252]</a> in the form of CoAP URLs, it does not explain how MUDs can be used in a CoAP network. Moreover, in CoAP the MUD file can be hosted on the CoAP endpoint itself, instead of hosting it on a dedicated MUD File Server.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#requirements-language" id="requirements-language">Requirements Language</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP&#160;14 <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#mud-architecture" id="mud-architecture">MUD Architecture</a>
</h1>
<p id="rfc.section.2.p.1">MUDs are defined in <a href="#RFC8520" class="xref">[RFC8520]</a> and are composed of:</p>
<p></p>

<ul>
<li>A URL that can be used to locate a description;</li>
<li>the description itself, including how it is interpreted; and</li>
<li>a means for local network management systems to retrieve the description;</li>
<li>which is retrieved from a MUD File Server.</li>
</ul>
<p id="rfc.section.2.p.3">In a MUD scenario, the end device is a &#8220;Thing&#8221; that exposes a &#8220;MUD URL&#8221; to the network. Routers or Switches in the path that speak MUD can forward the URL to &#8220;MUD Managers&#8221; that query a &#8220;MUD file server&#8221; and retrieve the &#8220;MUD File&#8221; from it. After processing, the &#8220;MUD Manager&#8221; applies an access policy to the IoT Thing.</p>
<div id="rfc.figure.1"></div>
<div id="arch-fig"></div>
<pre>
.......................................                      +-------+
.                      ____________   .                      |  MUD  |
.                     +            +  .          +-----------+-+File |
.                     |    MUD     +--&gt;get URL+-&gt;+    MUD      +-----+
.                     |  Manager   |  .(https)   | File Server |
.  End system network +____________+&lt;+MUD file&lt;-&lt;+-------------+
.                             .       .
.                             .       .
. _______                 _________   .
.+       + (DHCP et al.) + router  +  .
.| Thing +----&gt;MUD URL+-&gt;+   or    |  .
.+_______+               | switch  |  .
.                        +_________+  .
.......................................

</pre>
<p class="figure">Figure 1: Current MUD Architecture</p>
<p id="rfc.section.2.p.4">The general operation consists on a Thing emitting the MUD as a URL using DHCP, LLDP or through 802.1X, then a Switch or Router will send the URI to some IoT Controlling Entity. That Entity will fetch the MUD file from a Server on the Internet over HTTP.</p>
<p id="rfc.section.2.p.5">MUDs can be used to mitigate DDOS attacks to and from devices, for example by prohibiting unauthorized traffic to and from IoT devices. MUD also prevents devices from becoming the attacker, as that would require the device to send traffic to an unauthorized destination. Overall MUDs can be used to automatically permit the device to send and receive only the traffic it requires to perform its intended function.</p>
<p id="rfc.section.2.p.6">This is indeed an important subject as trustworthy IoT operations is a recurring topic in the IETF <a href="#RFC8576" class="xref">[RFC8576]</a>.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#problems" id="problems">Problems</a>
</h1>
<p id="rfc.section.2.1.p.1">The biggest issue with this architecture is that if the MUD File server is not available at a given time, no Thing can actually join the network. Relying on a single server is generally not a good idea. The DNS name may point to a load balancer group, but then that would require added infrastructure and complexity.</p>
<p id="rfc.section.2.1.p.2">Another potential issue is that MUD files seem to be oriented to classes of devices and not specific device instances. It could be that during bootstrapping or provisioning different devices of the same class have different properties and thus different MUD files, more granularity would be preferable. This could be achieved by creating per-device MUD files on the server, but that mechanism does not seem to have been currently specified.</p>
<p id="rfc.section.2.1.p.3">This brings us to the third problem, which is that the MUD file is somewhat static on a web server and out of the usual interaction patterns towards a device. In CoAP properties that are intrinsic to a device (e.g. sensing information) or configuration information (e.g. lwm2m objects used for management) are hosted by the device too, even if they could be replicated by a cloud server.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#mud-architecture-using-coap" id="mud-architecture-using-coap">MUD architecture using CoAP</a>
</h1>
<p><a href="#RFC8520" class="xref">[RFC8520]</a> allows a Thing to use the CoAP protocol scheme on the MUD URL. In this document we modify slightly the architecture. The components are:</p>
<p></p>

<ul>
<li>A URL using the &#8220;coaps://&#8221; scheme that can be used to locate a description;</li>
<li>the description itself, including how it is interpreted, which is now hosted and linked from &#8220;/.well-known/core&#8221; and</li>
<li>a means for local network management systems to retrieve the MUD description</li>
<li>which is hosted by the Thing itself acting as CoAP MUD File Server.</li>
</ul>
<div id="rfc.figure.2"></div>
<div id="arch2-fig"></div>
<pre>
...................................................
.                                  ____________   .
.                                 +            +  .
.             +------------------ |    MUD     |  .
.   get URL   |                   |  Manager   |  .
.   (coaps)   |                   +____________+  .
.  MUD file   |                         .         .
.             |                         .         .
.             |     End system network  .         .
.             |                         .         .
.           __v____                 _________     .
.          +       + (DHCP et al.) + router  +    .
.     +--- | Thing +----&gt;MUD URL+-&gt;+   or    |    .
.     |MUD +_______+               | switch  |    .
.     |File  |                     +_________+    .
.     +------+                                    .
...................................................
</pre>
<p class="figure">Figure 2: Self-hosted MUD Architecture</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#problems-1" id="problems-1">Problems</a>
</h1>
<p id="rfc.section.3.1.p.1">This design has some problems of its own. The main being that, if DHCP is restricted in the network, the device may not be able to advertise a functional MUD URL (<a href="#RFC8520" class="xref">[RFC8520]</a> Section 1.9).</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#finding-a-policy-mud-url-advertisement" id="finding-a-policy-mud-url-advertisement">Finding a policy: MUD URL advertisement</a>
</h1>
<p id="rfc.section.4.p.1">A CoAP endpoint will emit a URL that uses the CoAP scheme <a href="#RFC7252" class="xref">[RFC7252]</a>. This URL serves both to classify the device type and to provide a means to locate a policy file, as specified on <a href="#RFC8520" class="xref">[RFC8520]</a>.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#dynamic-host-configuration-protocol-dhcp" id="dynamic-host-configuration-protocol-dhcp">Dynamic Host Configuration Protocol (DHCP)</a>
</h1>
<p><a href="#RFC8520" class="xref">[RFC8520]</a> specifies a new MUD URL DHCP Option that carries the MUD URL to the DHCP Server. The functioning is the same as specified on <a href="#RFC8520" class="xref">[RFC8520]</a>.</p>
<p id="rfc.section.4.1.p.2">If the DHCP Server cannot provide a valid IPv4 or IPv6 address, the device may use a temporary IPv6 link-local address as base URI (e.g. <samp>coaps://[FE80::AB8]/mud/light-class</samp>). As link local is not a globally addressable address, the MUD Manager will only be able to reach the device if it is in the same network as the device.</p>
<p id="rfc.section.4.1.p.3">TBD : IPv4, coap://, &#8230;</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#neighbor-discovery-protocol-ndp" id="neighbor-discovery-protocol-ndp">Neighbor Discovery Protocol (NDP)</a>
</h1>
<p id="rfc.section.4.2.p.1">IPv6 hosts do not require DHCP to get access to the default gateway. <a href="#RFC4861" class="xref">[RFC4861]</a> can also be used to advertise the MUD URL.</p>
<p id="rfc.section.4.2.p.2">TBD : Figure out how these work - Neighbor Solicitation (type 135) - Neighbor Advertisement (type 136) - Redirect (type 137)</p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#ndp-on-6lowpans" id="ndp-on-6lowpans">NDP on 6LoWPANs</a>
</h1>
<p id="rfc.section.4.2.1.p.1">LoWPANs are characterized as lossy, low-power, low-bit-rate, short-range; with many nodes saving energy with long sleep periods. For that reason vanilla NDP <a href="#RFC4861" class="xref">[RFC4861]</a> might not be the most desiderable solution in such networks and optimizations like the ones provided by <a href="#RFC6775" class="xref">[RFC6775]</a> are required.</p>
<p id="rfc.section.4.2.1.p.2">TBD : Figure out how these work</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#stateless-autoconfiguration-slaac" id="stateless-autoconfiguration-slaac">Stateless autoconfiguration (SLAAC)</a>
</h1>
<p><a href="#RFC4862" class="xref">[RFC4862]</a> specifies how to create and auto configure link-local addresses during system startup.</p>
<p id="rfc.section.4.3.p.2">TBD : Figure out how these work</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#coap-operations" id="coap-operations">CoAP Operations</a>
</h1>
<p id="rfc.section.5.p.1">Things can expose MUDs as any other resource. MUD Managers can send a GET requests to a CoAP server for <samp>/.well-known/core</samp> and get in return a list of hypermedia links to other resources hosted in that server. Among those, it will get the path to the MUD file, for example <samp>/mud</samp> and Resource Types like <samp>rt=mud</samp>.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> <a href="#discovery" id="discovery">Discovery</a>
</h1>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#resource-directory" id="resource-directory">Resource Directory</a>
</h1>
<p id="rfc.section.5.1.1.p.1">By using <a href="#I-D.ietf-core-resource-directory" class="xref">[I-D.ietf-core-resource-directory]</a>, devices can register a MUD file on the Resource Directory and use it as a MUD repository too. Making it discoverable with the usual RD Lookup steps.</p>
<p id="rfc.section.5.1.1.p.2">Lookup will use the resource type <samp>rt=mud</samp>, the example in Link-Format <a href="#RFC6690" class="xref">[RFC6690]</a> is:</p>
<pre>
REQ: GET coap://rd.company.com/rd-lookup/res?rt=mud

RES: 2.05 Content

     &lt;coap://[2001:db8:3::101]/mud/box&gt;;rt=mud;
       anchor="coap://[2001:db8:3::101]"
     &lt;coap://[2001:db8:3::102]/mud/switch&gt;;rt=mud;
       anchor="coap://[2001:db8:3::102]",
     &lt;coap://[2001:db8:3::102]/mud/lock&gt;;rt=mud;
       anchor="coap://[2001:db8:3::102]",
     &lt;coap://[2001:db8:3::104]/mud/light&gt;;rt=mud;
       anchor="coap://[2001:db8:3::104]"
</pre>
<p id="rfc.section.5.1.1.p.3">The same example in CoRAL (<a href="#I-D.ietf-core-coral" class="xref">[I-D.ietf-core-coral]</a>, <a href="#I-D.hartke-t2trg-coral-reef" class="xref">[I-D.hartke-t2trg-coral-reef]</a>) is:</p>
<pre>
REQ: GET coap://rd.company.com/rd-lookup/res?rt=mud
     Accept: TBD123456 (application/coral+cbor@identity)

RES: 2.05 Content
     Content-Format: TBD123456 (application/coral+cbor@identity)
     
     rd-item &lt;coap://[2001:db8:3::101]/mud/box&gt; { rt "mud" }
     rd-item &lt;coap://[2001:db8:3::102]/mud/switch&gt; { rt "mud" }
     rd-item &lt;coap://[2001:db8:3::102]/mud/lock&gt; { rt "mud" }
     rd-item &lt;coap://[2001:db8:3::103]/mud/light&gt; { rt "mud" }
</pre>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#multicast" id="multicast">Multicast</a>
</h1>
<p><a href="#RFC7252" class="xref">[RFC7252]</a> registers one IPv4 and one IPv6 address each for the purpose of CoAP multicast. All CoAP Nodes can be addressed at <samp>224.0.1.187</samp> and at <samp>FF0X::FD</samp>. Multicast could also be used to discover all Manufacturer descriptions in a subnet.</p>
<p id="rfc.section.5.1.2.p.2">The example in Link-Format <a href="#RFC6690" class="xref">[RFC6690]</a> is:</p>
<pre>
GET coap://[FF0X::FE]/.well-known/core?rt=mud
</pre>
<p id="rfc.section.5.1.2.p.3">The same example in CoRAL (<a href="#I-D.ietf-core-coral" class="xref">[I-D.ietf-core-coral]</a>, <a href="#I-D.hartke-t2trg-coral-reef" class="xref">[I-D.hartke-t2trg-coral-reef]</a>) is:</p>
<pre>
REQ: GET coap://[FF0X::FE]/.well-known/core?rt=mud
     Accept: TBD123456 (application/coral+cbor@identity)
</pre>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#direct-mud-discovery" id="direct-mud-discovery">Direct MUD discovery</a>
</h1>
<p id="rfc.section.5.1.3.p.1">Using <a href="#RFC6690" class="xref">[RFC6690]</a> using CoRE Link Format, a CoAP endpoint could attempt to configure itself based on another Thing&#8217;s MUD. For that reason it might fetch directly the MUD file from the device. It would start by finding if the endpoint has a MUD. The example in Link-Format <a href="#RFC6690" class="xref">[RFC6690]</a> is:</p>
<pre>
REQ: GET coap://[2001:db8:3::123]:5683/.well-known/core?rt=mud

RES: 2.05 Content

     &lt;/mud/light&gt;;rt=mud
</pre>
<p id="rfc.section.5.1.3.p.2">In CoRAL (<a href="#I-D.ietf-core-coral" class="xref">[I-D.ietf-core-coral]</a>, <a href="#I-D.hartke-t2trg-coral-reef" class="xref">[I-D.hartke-t2trg-coral-reef]</a>):</p>
<pre>
REQ: GET coap://[2001:db8:3::123]:5683/.well-known/core?rt=mud
     Accept: TBD123456 (application/coral+cbor@identity)
     
RES: 2.05 Content
     Content-Format: TBD123456 (application/coral+cbor@identity)
     
     rd-item &lt;/mud/light&gt; { rt "mud" }
</pre>
<p id="rfc.section.5.1.3.p.3">Once the client knows that there is a MUD file under <samp>/mud/lightmud</samp>, it can decide to follow the presented links and query it.</p>
<pre>
REQ: GET coap://[2001:db8:3::123]:5683/mud/light
RES: 2.05 Content

     [{MUD Payload in SENML}]
</pre>
<p id="rfc.section.5.1.3.p.4">In CoRAL (<a href="#I-D.ietf-core-coral" class="xref">[I-D.ietf-core-coral]</a>, <a href="#I-D.hartke-t2trg-coral-reef" class="xref">[I-D.hartke-t2trg-coral-reef]</a>):</p>
<pre>
REQ: GET coap://[2001:db8:3::123]:5683/mud/light

RES: 2.05 Content

     [{MUD Payload in SENML}]
</pre>
<p id="rfc.section.5.1.3.p.5">The device may also observe the MUD resource using <a href="#RFC7641" class="xref">[RFC7641]</a>, directly subscribing to future network configuration changes.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#mud-file" id="mud-file">MUD File</a>
</h1>
<p id="rfc.section.6.p.1">TBD. Behaviors that are specific of CoAP should be here.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#serialization" id="serialization">Serialization</a>
</h1>
<p id="rfc.section.6.1.p.1">TBD. Write about SenML/CBOR MUDs.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">TBD.</p>
<p id="rfc.section.7.p.2">Things will expose a MUD file that has to be be signed both by the MUD author and by the device operator. Security Considerations present on Section 4.1 of <a href="#RFC8576" class="xref">[RFC8576]</a>.</p>
<p id="rfc.section.7.p.3">We might want to use BRSKI or another similar mechanism.</p>
<p id="rfc.section.7.p.4">Optionally the device could advertise localhost on the URL with the path to the MUD. When the network has the IP it&#8217;d append the path to it in order to fetch the MUD.</p>
<p id="rfc.section.7.p.5">If the host part is always dynamically computed how are bootstrap / attachment schemes that depend on certs (EAP) work?</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">TBD: rt=mud should be registered.</p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4861">[RFC4861]</b></td>
<td class="top">
<a>Narten, T.</a>, <a>Nordmark, E.</a>, <a>Simpson, W.</a> and <a>H. Soliman</a>, "<a href="https://tools.ietf.org/html/rfc4861">Neighbor Discovery for IP version 6 (IPv6)</a>", RFC 4861, DOI 10.17487/RFC4861, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4862">[RFC4862]</b></td>
<td class="top">
<a>Thomson, S.</a>, <a>Narten, T.</a> and <a>T. Jinmei</a>, "<a href="https://tools.ietf.org/html/rfc4862">IPv6 Stateless Address Autoconfiguration</a>", RFC 4862, DOI 10.17487/RFC4862, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6775">[RFC6775]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Chakrabarti, S.</a>, <a>Nordmark, E.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc6775">Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)</a>", RFC 6775, DOI 10.17487/RFC6775, November 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7252">[RFC7252]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Hartke, K.</a> and <a>C. Bormann</a>, "<a href="https://tools.ietf.org/html/rfc7252">The Constrained Application Protocol (CoAP)</a>", RFC 7252, DOI 10.17487/RFC7252, June 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8520">[RFC8520]</b></td>
<td class="top">
<a>Lear, E.</a>, <a>Droms, R.</a> and <a>D. Romascanu</a>, "<a href="https://tools.ietf.org/html/rfc8520">Manufacturer Usage Description Specification</a>", RFC 8520, DOI 10.17487/RFC8520, March 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.hartke-t2trg-coral-reef">[I-D.hartke-t2trg-coral-reef]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/draft-hartke-t2trg-coral-reef-03">Resource Discovery in Constrained RESTful Environments (CoRE) using the Constrained RESTful Application Language (CoRAL)</a>", Internet-Draft draft-hartke-t2trg-coral-reef-03, November 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coral">[I-D.ietf-core-coral]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-coral-03">The Constrained RESTful Application Language (CoRAL)</a>", Internet-Draft draft-ietf-core-coral-03, March 2020.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</b></td>
<td class="top">
<a>Shelby, Z.</a>, <a>Koster, M.</a>, <a>Bormann, C.</a>, <a>Stok, P.</a> and <a>C. Amsuess</a>, "<a href="https://tools.ietf.org/html/draft-ietf-core-resource-directory-23">CoRE Resource Directory</a>", Internet-Draft draft-ietf-core-resource-directory-23, July 2019.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6690">[RFC6690]</b></td>
<td class="top">
<a>Shelby, Z.</a>, "<a href="https://tools.ietf.org/html/rfc6690">Constrained RESTful Environments (CoRE) Link Format</a>", RFC 6690, DOI 10.17487/RFC6690, August 2012.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7641">[RFC7641]</b></td>
<td class="top">
<a>Hartke, K.</a>, "<a href="https://tools.ietf.org/html/rfc7641">Observing Resources in the Constrained Application Protocol (CoAP)</a>", RFC 7641, DOI 10.17487/RFC7641, September 2015.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8576">[RFC8576]</b></td>
<td class="top">
<a>Garcia-Morchon, O.</a>, <a>Kumar, S.</a> and <a>M. Sethi</a>, "<a href="https://tools.ietf.org/html/rfc8576">Internet of Things (IoT) Security: State of the Art and Challenges</a>", RFC 8576, DOI 10.17487/RFC8576, April 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.acknowledgments"><a href="#rfc.acknowledgments">Acknowledgments</a></h1>
<p id="rfc.section.A.p.1">Thanks to Thomas Fossati, Klaus Hartke, Carsten Bormann and Michael Richardson for discussions on the problem space and reviews.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jaime Jim&#233;nez</span> 
	  <span class="n hidden">
		<span class="family-name">Jim&#233;nez</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">Phone: +358-442-992-827</span>

<span class="vcardline">EMail: <a href="mailto:jaime@iki.fi">jaime@iki.fi</a></span>

  </address>
</div>

</body>
</html>

